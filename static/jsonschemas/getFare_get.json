{
  "description": "A collection of fares for a product, user profile, entitlement, and card type.",
  "type": "object",
  "properties": {
    "type": {
      "type": "string",
      "pattern": "^(FeatureCollection)$"
    },
    "features": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "pattern": "^(Feature)$"
          },
          "id": {
            "type": "string"
          },
          "properties": {
            "type": "object",
            "additionalProperties": true,
            "properties": {
              "userProfile": {
                "type": "string",
                "description": "default string, full names etc (length 0-200)",
                "maxLength": 200
              },
              "cardType": {
                "type": "string",
                "description": "default string, full names etc (length 0-200)",
                "maxLength": 200
              },
              "entitlement": {
                "type": "string",
                "description": "default string, full names etc (length 0-200)",
                "maxLength": 200
              },
              "validity": {
                "type": "array",
                "minItems": 2,
                "maxItems": 2,
                "items": {
                  "type": "string",
                  "format": "date-time",
                  "x-pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
                  "description": "https://www.rfc-editor.org/rfc/rfc3339#section-5.6, date-time (2019-10-12T07:20:50.52Z)"
                }
              },
              "fare": {
                "x-semantics": [
                  {
                    "transmodel": "TARIFF"
                  }
                ],
                "allOf": [
                  {
                    "type": "object",
                    "x-semantics": [
                      {
                        "transmodel": "FARE PRICE"
                      }
                    ],
                    "description": "an amount of money, usable in fares, fare calculations or in extra costs.",
                    "required": [
                      "amount"
                    ],
                    "properties": {
                      "amount": {
                        "type": "number",
                        "format": "float",
                        "description": "This should be in the base unit as defined by the ISO 4217 currency code with the appropriate number of decimal places and omitting the currency symbol. e.g. if the price is in US Dollars the price would be 9.95. This is inclusive VAT"
                      },
                      "taxPercentageUsed": {
                        "type": "number",
                        "description": "the travelled distance. Only if applicable.",
                        "format": "float",
                        "minimum": 0
                      },
                      "currencyCode": {
                        "type": "string",
                        "x-semantics": [
                          {
                            "transmodel": "PRICE UNIT"
                          }
                        ],
                        "description": "ISO 4217 currency code",
                        "minLength": 3,
                        "maxLength": 3,
                        "pattern": "[a-zA-Z]{3}"
                      },
                      "vatCountryCode": {
                        "type": "string",
                        "x-semantics": [
                          {
                            "transmodel": "COUNTRY"
                          }
                        ],
                        "description": "two-letter country codes according to ISO 3166-1",
                        "maxLength": 2,
                        "minLength": 2,
                        "pattern": "[A-Z]{2}"
                      }
                    }
                  },
                  {
                    "type": "object",
                    "description": "the total fare is the sum of all parts, except for the 'MAX' fareStructureElement. This one descripes the maximum price for the complete leg.",
                    "required": [
                      "elements"
                    ],
                    "properties": {
                      "id": {
                        "type": "string",
                        "description": "default string, full names etc (length 0-200)",
                        "maxLength": 200
                      },
                      "estimated": {
                        "type": "boolean",
                        "description": "is this fare an estimation?"
                      },
                      "description": {
                        "type": "string",
                        "description": "default string, full names etc (length 0-200)",
                        "maxLength": 200
                      },
                      "userProfiles": {
                        "type": "array",
                        "description": "references to applicable user profiles",
                        "items": {
                          "type": "string",
                          "description": "default string, full names etc (length 0-200)",
                          "maxLength": 200
                        }
                      },
                      "temporalValidity": {
                        "type": "array",
                        "minItems": 2,
                        "maxItems": 2,
                        "items": {
                          "type": "string",
                          "format": "date-time",
                          "x-pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
                          "description": "https://www.rfc-editor.org/rfc/rfc3339#section-5.6, date-time (2019-10-12T07:20:50.52Z)"
                        }
                      },
                      "yieldPriceUrl": {
                        "type": "object",
                        "additionalProperties": false,
                        "x-externalDocs": {
                          "url": "http://schemas.opengis.net/ogcapi/features/part1/1.0/openapi/schemas/link.yaml"
                        },
                        "required": [
                          "href",
                          "rel"
                        ],
                        "properties": {
                          "rel": {
                            "type": "string",
                            "description": "the action that can be performed OR part of the URI allowed values include the 'processId's, prefixes for the referenced data sources, prefixes for deeplinks ('apple' and 'android'), OGC compliant ones (alternative, next, etc)"
                          },
                          "href": {
                            "type": "string",
                            "description": "valid URL",
                            "format": "uri"
                          },
                          "type": {
                            "type": "string",
                            "description": "short string, display names (length 0-75)",
                            "maxLength": 75
                          },
                          "method": {
                            "type": "string",
                            "description": "to indicate the http method.",
                            "default": "GET",
                            "enum": [
                              "POST",
                              "GET",
                              "DELETE",
                              "PATCH"
                            ]
                          },
                          "description": {
                            "type": "string",
                            "description": "the description of the external data source"
                          },
                          "body": {
                            "type": "object",
                            "description": "the (prefilled) body for the request"
                          },
                          "headers": {
                            "type": "object",
                            "additionalProperties": {
                              "type": "string"
                            }
                          },
                          "mandatory": {
                            "description": "is this link informative, or must it be used?",
                            "type": "boolean"
                          },
                          "hash": {
                            "description": "to validate that the content of the link hasn't been changed.",
                            "type": "string"
                          },
                          "expires": {
                            "type": "string",
                            "format": "date-time",
                            "x-pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
                            "description": "https://www.rfc-editor.org/rfc/rfc3339#section-5.6, date-time (2019-10-12T07:20:50.52Z)"
                          }
                        }
                      },
                      "elements": {
                        "type": "array",
                        "maxItems": 25,
                        "items": {
                          "x-semantics": [
                            {
                              "transmodel": "TIME INTERVAL PRICE, TIME UNIT PRICE, GEOGRAPHICAL UNIT PRICE, GEOGRAPHICAL INTERVAL PRICE, LIMITING RULE"
                            }
                          ],
                          "description": "this describes a part of the fare (or discount). It contains a for instance the startup costs (fixed) or the flex part (e.g. 1.25 EUR per 2.0 MILES). The amount is tax included. In case of discounts, the values are negative. With 'MAX' you can specify e.g. a maximum of 15 euro per day. Percentage is mainly added for discounts. The `scale` properties create the ability to communicate scales (e.g. the first 4 kilometers you've to pay EUR 0.35 per kilometer, the kilometers 4 until 8 EUR 0.50 and above it EUR 0.80 per kilometer).",
                          "allOf": [
                            {
                              "type": "object",
                              "x-semantics": [
                                {
                                  "transmodel": "FARE PRICE"
                                }
                              ],
                              "description": "an amount of money, usable in fares, fare calculations or in extra costs.",
                              "required": [
                                "amount"
                              ],
                              "properties": {
                                "amount": {
                                  "type": "number",
                                  "format": "float",
                                  "description": "This should be in the base unit as defined by the ISO 4217 currency code with the appropriate number of decimal places and omitting the currency symbol. e.g. if the price is in US Dollars the price would be 9.95. This is inclusive VAT"
                                },
                                "taxPercentageUsed": {
                                  "type": "number",
                                  "description": "the travelled distance. Only if applicable.",
                                  "format": "float",
                                  "minimum": 0
                                },
                                "currencyCode": {
                                  "type": "string",
                                  "x-semantics": [
                                    {
                                      "transmodel": "PRICE UNIT"
                                    }
                                  ],
                                  "description": "ISO 4217 currency code",
                                  "minLength": 3,
                                  "maxLength": 3,
                                  "pattern": "[a-zA-Z]{3}"
                                },
                                "vatCountryCode": {
                                  "type": "string",
                                  "x-semantics": [
                                    {
                                      "transmodel": "COUNTRY"
                                    }
                                  ],
                                  "description": "two-letter country codes according to ISO 3166-1",
                                  "maxLength": 2,
                                  "minLength": 2,
                                  "pattern": "[A-Z]{2}"
                                }
                              }
                            },
                            {
                              "type": "object",
                              "required": [
                                "type"
                              ],
                              "properties": {
                                "type": {
                                  "type": "string",
                                  "description": "type of fare structure element. If there is only one fare structure elements and this field is missing, it should be assumed it is 'FIXED'. In all other situations this field is mandatory.<br> _FIXED_ fixed element, independend on the duration or distance traveled. _FLEX_ flex element, dependend on the duration or distance of the package. Can be tiered. _MAX_ capping mechanism. Calculate the price using the sum of the FIXED and FLEX elements, cap it using this rule. Max 1 per fare structure.",
                                  "enum": [
                                    "FIXED",
                                    "FLEX",
                                    "MAX"
                                  ]
                                },
                                "priceCondition": {
                                  "type": "string",
                                  "description": "is this the default price or is this an additional part (discount, price surge). <br> _DEFAULT_ the default price for this price part<br> _DISCOUNT_ the amount must always be negative <br> _SURGE_ the amount must always be positive <br> This also means, that when you're working with discounts or surges, you have to deliver 2 fare structure elements, one for the default price and one for the discount/surge. This can be used in combination with as well the fixed price parts as with the flex price parts.",
                                  "enum": [
                                    "DEFAULT",
                                    "DISCOUNT",
                                    "SURGE"
                                  ]
                                },
                                "units": {
                                  "type": "string",
                                  "description": "in case of 'FLEX' mandatory, otherwise not allowed. E.g. 0.5 EUR per HOUR",
                                  "enum": [
                                    "KM",
                                    "SECOND",
                                    "MINUTE",
                                    "HOUR",
                                    "MILE",
                                    "PERCENTAGE",
                                    "ZONE"
                                  ]
                                },
                                "amountOfUnits": {
                                  "type": "number",
                                  "description": "the travelled distance. Only if applicable.",
                                  "format": "float",
                                  "minimum": 0
                                },
                                "scale": {
                                  "x-semantics": [
                                    {
                                      "transmodel": "TIME INTERVAL (in case UNITS = minutes or hours)"
                                    }
                                  ],
                                  "type": "object",
                                  "required": [
                                    "from",
                                    "to",
                                    "units"
                                  ],
                                  "properties": {
                                    "from": {
                                      "type": "number",
                                      "description": "the travelled distance. Only if applicable.",
                                      "format": "float",
                                      "minimum": 0
                                    },
                                    "to": {
                                      "type": "number",
                                      "description": "the travelled distance. Only if applicable.",
                                      "format": "float",
                                      "minimum": 0
                                    },
                                    "units": {
                                      "type": "string",
                                      "description": "the units is normally the same as the **interval.units**, but it doesn't have to be. For instance, you could pay 1 EUR per kilometer for the first hour.",
                                      "enum": [
                                        "KM",
                                        "MILE",
                                        "HOUR",
                                        "MINUTE",
                                        "ZONE",
                                        "CURRENCY"
                                      ]
                                    }
                                  }
                                },
                                "priceInterval": {
                                  "x-semantics": [
                                    {
                                      "transmodel": "TIME INTERVAL (in case UNITS = minutes or hours)"
                                    }
                                  ],
                                  "type": "object",
                                  "required": [
                                    "from",
                                    "to",
                                    "units"
                                  ],
                                  "properties": {
                                    "from": {
                                      "type": "number",
                                      "description": "the travelled distance. Only if applicable.",
                                      "format": "float",
                                      "minimum": 0
                                    },
                                    "to": {
                                      "type": "number",
                                      "description": "the travelled distance. Only if applicable.",
                                      "format": "float",
                                      "minimum": 0
                                    },
                                    "units": {
                                      "type": "string",
                                      "description": "the units is normally the same as the **interval.units**, but it doesn't have to be. For instance, you could pay 1 EUR per kilometer for the first hour.",
                                      "enum": [
                                        "KM",
                                        "MILE",
                                        "HOUR",
                                        "MINUTE",
                                        "ZONE",
                                        "CURRENCY"
                                      ]
                                    }
                                  }
                                },
                                "name": {
                                  "type": "string",
                                  "description": "default string, full names etc (length 0-200)",
                                  "maxLength": 200
                                },
                                "appliesTo": {
                                  "type": "string",
                                  "description": "class of this fare structure element. Could be FARE or ANCILLARY<br> _FARE_ this fare structure element is related to the distance or time of usage.<br> _ANCILLARY_ this fare structure element is related to the rental of one or more ancillaries.",
                                  "default": "FARE",
                                  "enum": [
                                    "FARE",
                                    "ANCILLARY"
                                  ]
                                },
                                "assetCondition": {
                                  "type": "string",
                                  "description": "in case the fare is dependent on being in use or being paused, this field must be used. Default IN_USE",
                                  "enum": [
                                    "IN_USE",
                                    "PAUSED"
                                  ],
                                  "default": "IN_USE"
                                },
                                "customFields": {
                                  "type": "object",
                                  "description": "dictionary for extra fields (bilatural agreements)",
                                  "additionalProperties": {
                                    "maxLength": 1000,
                                    "maxProperties": 20
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      }
    },
    "properties": {
      "type": "object",
      "additionalProperties": true,
      "description": "add the used query parameters in here (proof)",
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "fares"
          ]
        },
        "userProfile": {
          "type": "string",
          "description": "default string, full names etc (length 0-200)",
          "maxLength": 200
        },
        "cardType": {
          "type": "string",
          "description": "default string, full names etc (length 0-200)",
          "maxLength": 200
        },
        "entitlement": {
          "type": "string",
          "description": "default string, full names etc (length 0-200)",
          "maxLength": 200
        },
        "limit": {
          "type": "integer",
          "description": "The maximum number of items to return."
        },
        "offset": {
          "type": "integer",
          "description": "The offset for pagination."
        },
        "bbox": {
          "type": "array",
          "items": {
            "type": "number"
          },
          "minItems": 4,
          "maxItems": 4,
          "description": "Bounding box for spatial filtering, in the format [minLon, minLat, maxLon, maxLat]."
        }
      }
    },
    "numberMatched": {
      "type": "number"
    },
    "numberReturned": {
      "type": "number"
    },
    "links": {
      "type": "array",
      "description": "actions that can be performed on this package, but also alternative (rel=alternative+1, alternative+2) offers or references to other resources In case it is an alternative, specify clearly in the description what the financial consequences are.",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "x-externalDocs": {
          "url": "http://schemas.opengis.net/ogcapi/features/part1/1.0/openapi/schemas/link.yaml"
        },
        "required": [
          "href",
          "rel"
        ],
        "properties": {
          "rel": {
            "type": "string",
            "description": "the action that can be performed OR part of the URI allowed values include the 'processId's, prefixes for the referenced data sources, prefixes for deeplinks ('apple' and 'android'), OGC compliant ones (alternative, next, etc)"
          },
          "href": {
            "type": "string",
            "description": "valid URL",
            "format": "uri"
          },
          "type": {
            "type": "string",
            "description": "short string, display names (length 0-75)",
            "maxLength": 75
          },
          "method": {
            "type": "string",
            "description": "to indicate the http method.",
            "default": "GET",
            "enum": [
              "POST",
              "GET",
              "DELETE",
              "PATCH"
            ]
          },
          "description": {
            "type": "string",
            "description": "the description of the external data source"
          },
          "body": {
            "type": "object",
            "description": "the (prefilled) body for the request"
          },
          "headers": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          },
          "mandatory": {
            "description": "is this link informative, or must it be used?",
            "type": "boolean"
          },
          "hash": {
            "description": "to validate that the content of the link hasn't been changed.",
            "type": "string"
          },
          "expires": {
            "type": "string",
            "format": "date-time",
            "x-pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}Z$",
            "description": "https://www.rfc-editor.org/rfc/rfc3339#section-5.6, date-time (2019-10-12T07:20:50.52Z)"
          }
        }
      }
    }
  }
}